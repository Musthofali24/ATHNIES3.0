<script>
  var form = document.getElementById("sheetdb-form");
  var submitButton = form.querySelector(".absent__btn");

  form.addEventListener("submit", (e) => {
    e.preventDefault();

    // Menonaktifkan tombol submit
    submitButton.disabled = true;
    submitButton.textContent = "Submitting...";

    fetch(form.action, {
      method: "POST",
      body: new FormData(document.getElementById("sheetdb-form")),
    })
      .then((response) => response.json())
      .then((html) => {
        // Mengganti URL ke success.html setelah pengiriman berhasil
        window.location.replace("success.html");
      })
      .catch((error) => {
        console.error("Error:", error);
      })
      .finally(() => {
        // Mengaktifkan kembali tombol submit setelah selesai
        submitButton.disabled = false;
        submitButton.textContent = "Submit";
      });
  });
</script>
